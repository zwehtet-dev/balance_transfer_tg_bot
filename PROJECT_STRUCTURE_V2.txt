Balance Transfer Telegram Bot v2.0 - Project Structure
=======================================================

telegram_bot/
â”‚
â”œâ”€â”€ bot/                           # Main application package
â”‚   â”œâ”€â”€ __init__.py               # Package initialization (v2.0.0)
â”‚   â”œâ”€â”€ main.py                   # Application entry point
â”‚   â”‚
â”‚   â”œâ”€â”€ models/                   # Data models & database layer
â”‚   â”‚   â”œâ”€â”€ __init__.py          # Models package exports
â”‚   â”‚   â”œâ”€â”€ database.py          # Database connection & schema
â”‚   â”‚   â”œâ”€â”€ user.py              # User domain model
â”‚   â”‚   â””â”€â”€ transaction.py       # Transaction domain model
â”‚   â”‚
â”‚   â”œâ”€â”€ services/                 # Business logic layer
â”‚   â”‚   â”œâ”€â”€ __init__.py          # Services package exports
â”‚   â”‚   â”œâ”€â”€ user_service.py      # User CRUD operations
â”‚   â”‚   â”œâ”€â”€ transaction_service.py # Transaction operations
â”‚   â”‚   â”œâ”€â”€ balance_service.py   # Balance & transfer logic
â”‚   â”‚   â””â”€â”€ bot_service.py       # Main bot orchestration
â”‚   â”‚
â”‚   â”œâ”€â”€ handlers/                 # Telegram command handlers
â”‚   â”‚   â”œâ”€â”€ __init__.py          # Handlers package exports
â”‚   â”‚   â””â”€â”€ command_handlers.py  # All bot command handlers
â”‚   â”‚
â”‚   â””â”€â”€ utils/                    # Utility modules
â”‚       â”œâ”€â”€ __init__.py          # Utils package exports
â”‚       â”œâ”€â”€ config.py            # Configuration management
â”‚       â””â”€â”€ logger.py            # Logging setup
â”‚
â”œâ”€â”€ tests/                        # Test suite
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ test_balance_service.py  # Balance service tests
â”‚   â”œâ”€â”€ test_user_service.py     # User service tests
â”‚   â”œâ”€â”€ test_models.py           # Model tests (v1.0)
â”‚   â””â”€â”€ test_services.py         # Service tests (v1.0)
â”‚
â”œâ”€â”€ data/                         # Data directory (created at runtime)
â”‚   â””â”€â”€ bot.db                   # SQLite database
â”‚
â”œâ”€â”€ logs/                         # Log directory (created at runtime)
â”‚   â””â”€â”€ bot.log                  # Application logs
â”‚
â”œâ”€â”€ balance_bot/                  # Old v1.0 structure (deprecated)
â”‚   â””â”€â”€ ...                      # Legacy files
â”‚
â”œâ”€â”€ .env                          # Environment variables (not in git)
â”œâ”€â”€ .env.example                  # Environment template
â”œâ”€â”€ .gitignore                    # Git exclusions
â”‚
â”œâ”€â”€ requirements.txt              # Python dependencies
â”œâ”€â”€ setup.sh                      # Automated setup script
â”œâ”€â”€ run.py                        # Convenience runner
â”œâ”€â”€ Makefile                      # Common commands
â”‚
â”œâ”€â”€ README.md                     # Original documentation
â”œâ”€â”€ README_V2.md                  # v2.0 documentation
â”œâ”€â”€ QUICKSTART.md                 # Quick start guide
â”œâ”€â”€ ARCHITECTURE.md               # v1.0 architecture
â”œâ”€â”€ MIGRATION_GUIDE.md            # v1.0 â†’ v2.0 migration
â”œâ”€â”€ IMPROVEMENTS.md               # v1.0 improvements
â”œâ”€â”€ CHANGELOG.md                  # Version history
â””â”€â”€ PROJECT_STRUCTURE_V2.txt      # This file

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š File Statistics (v2.0):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Core Application:
  bot/main.py                    ~50 lines   - Entry point
  bot/models/database.py         ~150 lines  - Database layer
  bot/models/user.py             ~30 lines   - User model
  bot/models/transaction.py      ~40 lines   - Transaction model
  bot/services/user_service.py   ~80 lines   - User operations
  bot/services/transaction_service.py ~120 lines - Transaction ops
  bot/services/balance_service.py ~100 lines  - Business logic
  bot/services/bot_service.py    ~100 lines  - Bot orchestration
  bot/handlers/command_handlers.py ~200 lines - Command handlers
  bot/utils/config.py            ~50 lines   - Configuration
  bot/utils/logger.py            ~40 lines   - Logging setup

Total Core: ~960 lines of production code

Tests:
  tests/test_balance_service.py  ~80 lines
  tests/test_user_service.py     ~70 lines

Total Tests: ~150 lines

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ—ï¸ Architecture Layers:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Layer 1: Presentation (Handlers)
  â””â”€â”€ bot/handlers/command_handlers.py
      â”œâ”€â”€ Telegram command handlers
      â”œâ”€â”€ User interaction
      â”œâ”€â”€ Message formatting
      â””â”€â”€ Conversation flows

Layer 2: Business Logic (Services)
  â””â”€â”€ bot/services/
      â”œâ”€â”€ balance_service.py      - Transfer logic
      â”œâ”€â”€ user_service.py         - User management
      â”œâ”€â”€ transaction_service.py  - Transaction tracking
      â””â”€â”€ bot_service.py          - Application orchestration

Layer 3: Domain Models
  â””â”€â”€ bot/models/
      â”œâ”€â”€ user.py                 - User entity
      â”œâ”€â”€ transaction.py          - Transaction entity
      â””â”€â”€ database.py             - Database abstraction

Layer 4: Data Storage
  â””â”€â”€ SQLite Database (data/bot.db)
      â”œâ”€â”€ users table
      â”œâ”€â”€ transactions table
      â””â”€â”€ indexes

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ—„ï¸ Database Schema:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

users
  â”œâ”€â”€ id (INTEGER PRIMARY KEY)
  â”œâ”€â”€ name (TEXT UNIQUE)
  â”œâ”€â”€ balance (REAL)
  â”œâ”€â”€ created_at (TIMESTAMP)
  â””â”€â”€ updated_at (TIMESTAMP)

transactions
  â”œâ”€â”€ id (INTEGER PRIMARY KEY)
  â”œâ”€â”€ from_user_id (INTEGER FK)
  â”œâ”€â”€ to_user_id (INTEGER FK)
  â”œâ”€â”€ amount (REAL)
  â”œâ”€â”€ balance_from (REAL)
  â”œâ”€â”€ balance_to (REAL)
  â””â”€â”€ created_at (TIMESTAMP)

indexes
  â”œâ”€â”€ idx_transactions_from_user
  â”œâ”€â”€ idx_transactions_to_user
  â””â”€â”€ idx_transactions_created_at

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”„ Data Flow Example (Transfer):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. User sends /transfer
   â†“
2. CommandHandlers.transfer_start()
   - Shows direction selection
   â†“
3. User selects direction
   â†“
4. CommandHandlers.transfer_direction()
   - Stores context, requests amount
   â†“
5. User enters amount
   â†“
6. CommandHandlers.transfer_amount()
   - Parses input
   - Calls BalanceService.transfer()
   â†“
7. BalanceService.transfer()
   - Validates amount
   - Gets users via UserService
   - Checks balance
   - Updates balances via UserService
   - Creates transaction via TransactionService
   â†“
8. UserService.update_balance()
   - Executes SQL UPDATE
   â†“
9. TransactionService.create()
   - Executes SQL INSERT
   â†“
10. Returns TransferResult
   â†“
11. Handler formats and sends response

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸš€ Key Improvements in v2.0:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… SQLite Database
   - Persistent, reliable storage
   - ACID transactions
   - Indexed queries

âœ… Scalable Architecture
   - Clear separation of concerns
   - Service layer pattern
   - Repository pattern

âœ… Enhanced Performance
   - Database indexes
   - Efficient queries
   - Connection pooling

âœ… Better Testing
   - Isolated test database
   - Comprehensive test coverage
   - Mock-friendly design

âœ… Production Ready
   - Robust error handling
   - Structured logging
   - Configuration management

âœ… New Features
   - /stats command
   - Unlimited transaction history
   - Better query capabilities

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¦ Dependencies:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Production:
  - python-telegram-bot==20.7
  - python-dotenv==1.0.0

Development:
  - pytest==7.4.3
  - pytest-asyncio==0.21.1
  - pytest-cov==4.1.0
  - pytest-mock==3.12.0

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ Design Patterns:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Service Layer Pattern
   - Business logic in services
   - Reusable across interfaces

2. Repository Pattern
   - Data access abstraction
   - UserService, TransactionService

3. Dependency Injection
   - Services receive dependencies
   - Easy testing and mocking

4. Result Object Pattern
   - TransferResult for operations
   - Rich return values

5. Factory Pattern
   - Database initialization
   - Model creation

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”§ Configuration:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Environment Variables:
  TELEGRAM_BOT_TOKEN     - Bot token (required)
  DATABASE_URL           - SQLite database path
  DEFAULT_BALANCE        - Initial user balance
  MAX_TRANSACTION_HISTORY - History limit
  LOG_LEVEL              - Logging level
  LOG_FILE               - Log file path

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ Bot Commands:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

/start      - Welcome message
/balance    - Check balances
/transfer   - Transfer money
/history    - View transactions
/stats      - View statistics (NEW in v2.0)
/reset      - Reset balances
/help       - Show help

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ Best Practices Applied:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… SOLID Principles
âœ… Clean Architecture
âœ… Database Normalization
âœ… SQL Injection Prevention
âœ… Error Handling
âœ… Logging Strategy
âœ… Configuration Management
âœ… Test-Driven Development
âœ… Documentation
âœ… Version Control

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Version: 2.0.0
Database: SQLite
Python: 3.8+
Framework: python-telegram-bot 20.7
Architecture: Layered, Service-Oriented
